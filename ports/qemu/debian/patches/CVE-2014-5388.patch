From fa365d7cd11185237471823a5a33d36765454e16 Mon Sep 17 00:00:00 2001
From: Gonglei <arei.gonglei@huawei.com>
Date: Wed, 20 Aug 2014 13:52:30 +0800
Subject: [PATCH] pcihp: fix possible array out of bounds

Prevent out-of-bounds array access on
acpi_pcihp_pci_status.

Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Reviewed-by: Peter Crosthwaite <peter.crosthwaite@xilinx.com>
Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Cc: qemu-stable@nongnu.org
Reviewed-by: Marcel Apfelbaum <marcel@redhat.com>
---
 hw/acpi/pcihp.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

Index: qemu-2.0.0+dfsg/hw/acpi/pcihp.c
===================================================================
--- qemu-2.0.0+dfsg.orig/hw/acpi/pcihp.c	2014-11-11 14:17:19.343939391 -0500
+++ qemu-2.0.0+dfsg/hw/acpi/pcihp.c	2014-11-11 14:17:19.343939391 -0500
@@ -229,7 +229,7 @@
     uint32_t val = 0;
     int bsel = s->hotplug_select;
 
-    if (bsel < 0 || bsel > ACPI_PCIHP_MAX_HOTPLUG_BUS) {
+    if (bsel < 0 || bsel >= ACPI_PCIHP_MAX_HOTPLUG_BUS) {
         return 0;
     }
 
